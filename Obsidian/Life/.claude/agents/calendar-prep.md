# Calendar Prep Agent

Generate pre-meeting briefings for today's calls by pulling context from RMEs and DCNs.

## Schedule

- **Primary:** 6:30am weekdays (runs with Daily Intelligence)
- **On-demand:** User can invoke for specific meeting

## Trigger

```bash
claude --agent calendar-prep
```

## Dependency

**Requires:** Microsoft Graph API access (Calendars.Read)

**Status:** Blocked until 365 auth resolved

## Purpose

For each meeting today, prepare:
1. Who you're meeting with (linked to RMEs)
2. What you last discussed
3. Deal context if relevant
4. Suggested talking points
5. Open items to address

## Processing Steps

### 1. Fetch Today's Calendar

Using MSFT Graph API:
```
GET /me/calendar/events
  ?$filter=start ge {today} and end lt {tomorrow}
  &$select=subject,attendees,start,end,location
```

Filter to relevant meetings:
- Exclude internal-only meetings (optional)
- Exclude blocked time / focus time
- Include external calls and deal meetings

### 2. For Each Meeting, Identify Attendees

Parse attendee list from calendar event.

For each external attendee:
- Extract email domain
- Match to RME by:
  1. Email address in Key Contacts table
  2. Email domain matching known org
  3. Name match in Key Contacts

Flag any attendees with no RME match.

### 3. Load RME Context

For each matched RME:
- **Last interaction:** Most recent entry from Interaction Log
- **Key contacts:** Who from their side, any notes
- **Intelligence highlights:** Recent entries, key info
- **Investment criteria:** If relevant to discussion
- **Deal involvement:** Active deals they're on

### 4. Load DCN Context

Determine relevant DCNs:
- From meeting subject line (deal name mentioned)
- From RME Current Status (deal involvement)
- From recent activity (RME in DCN counterparties)

For each relevant DCN:
- Current phase and milestone
- Recent activity (last 2 weeks)
- Blockers
- Their positioning (from Investor Tracking if exists)

### 5. Identify Open Items

Scan for unresolved items involving these attendees:
- Tasks tagged with deal and not completed
- Commitments from last call ("we said we'd send...")
- Questions flagged for follow-up
- Blockers they can help resolve

### 6. Generate Meeting Prep

For each meeting:

```markdown
## 10:00 - Call with Norfund

**Attendees:**
- Lars Hansen (Investment Director) - [[00. RME Norfund]]
- Siri Olsen (Analyst) - [[00. RME Norfund]]

**Last Contact:** 2026-01-28 - Call re: CBE Equity pricing ([[Call Notes 2026-01-28]])

**Deal Context:** [[0. DCN CBE Equity]]
- Phase: NBO/Term Sheet
- Their status: NBO submitted, in negotiation
- Blocker: Pricing gap (they want 12%, we're at 10.5%)

**Recent Intelligence:**
- Fund III is 80% deployed, pressure to close deals (2026-01-15)
- New Principal Erik Johansen joining renewables team (2026-02-01)

**Open Items:**
- [ ] We committed to send revised model (Call 2026-01-28)
- [ ] They asked for reference call with existing portfolio company

**Suggested Talking Points:**
1. Address pricing gap - any flexibility on their side?
2. Reference call - have we arranged?
3. Timeline to binding offer - their IC schedule?
4. Erik joining - intro opportunity?

---
```

### 7. Compile Day's Prep

Combine all meeting preps:

```markdown
# Meeting Prep - YYYY-MM-DD

## Summary
- 3 external meetings today
- 2 deal-related, 1 BD catch-up

## Meetings

### 10:00 - Call with Norfund
[Full prep as above]

### 14:00 - Gridworks Deal Review
[Full prep]

### 16:30 - Coffee with [Contact] (BD)
[Full prep]

---

## Attendees Without RME

- john.smith@newcompany.com - Consider creating RME?

---
*Generated by calendar-prep agent*
```

### 8. Feed into Daily Intelligence

Pass meeting summaries to `daily-intelligence`:
- Meeting times with RME links
- Key prep notes (e.g., "last spoke 2 weeks ago")
- Flags for meetings needing extra attention

### 9. Save Prep Document

Save to:
```
Work/Meeting Prep/Meeting Prep YYYY-MM-DD.md
```

Also inject summary into Daily Scratchpad under relevant transaction sections.

## Prep Depth Levels

| Meeting Type | Prep Depth |
|--------------|------------|
| Key investor, active deal | Full (context, intel, open items, talking points) |
| Regular check-in | Medium (last contact, deal status, open items) |
| BD / exploratory | Light (RME summary, suggested topics) |
| Internal only | Skip or minimal |

## Skills Invoked

- Outputs feed into `daily-intelligence`
- May invoke `create-rme` for new attendees
- References `process-call-notes` output for last interaction

## Error Handling

| Issue | Handling |
|-------|----------|
| No calendar access | Skip, note in Daily Intelligence that calendar not available |
| Attendee not matched | Flag in prep, suggest creating RME |
| No recent interaction | Flag as "cold" - may need warm-up before meeting |
| Deal context unclear | Include multiple possible DCNs, let user clarify |

## Future Enhancements

- Auto-send prep via email 30 min before meeting
- Slack reminder with key points
- Post-meeting auto-trigger for call notes creation
